<!DOCTYPE html>
<html>
    <!-- Mostly copied from https://docs.dhtmlx.com/scheduler/howtostart_nodejs.html#step2addingschedulertothepage -->
    <head>
        <title>{{ specification["title"] | safe }}</title>
        <meta charset="utf-8">
        <script type="text/javascript">
            var specification = {{ specification | tojson | safe }};
        </script>
        <!-- scheduler -->
        <script src="js/dhtmlx/dhtmlxscheduler.js"
            charset="utf-8"></script>
        <script src="js/configure.js"
            charset="utf-8"></script>
        <link href="css/dhtmlx/{{ specification['skin'] | safe }}"
            rel="stylesheet" type="text/css" charset="utf-8">
        <link href="css/dhtmlx/style.css"
            rel="stylesheet" type="text/css" charset="utf-8">
        <!-- see https://docs.dhtmlx.com/scheduler/localization.html -->
        <script src="js/dhtmlx/locale/locale_{{ specification['language'] | safe }}.js" charset="utf-8"></script>
        <script>
            
            window.addEventListener("DOMContentLoaded", function(){

                // different configs for different screen sizes
                var compactView = {
                    xy: {
                        nav_height: 80
                    },
                    config: {
                        header: {
                            rows: [
                                { 
                                    cols: [
                                        "prev",
                                        "date",
                                        "next"
                                    ]
                                },
                                { 
                                    cols: [
                                        "day",
                                        "week",
                                        "month",
                                        "spacer",
                                        "today"
                                    ]
                                }
                            ]
                        }
                    },
                    templates: {
                        month_scale_date: scheduler.date.date_to_str("%D"),
                        week_scale_date: scheduler.date.date_to_str("%D, %j"),
                        event_bar_date: function(start,end,ev) {
                            return "";
                        }

                    }
                };
                var fullView = {
                    xy: {
                        nav_height: 80
                    },
                    config: {
                        header: [
                            "day",
                            "week",
                            "month",
                            "date",
                            "prev",
                            "today",
                            "next"
                        ]
                    },
                    templates: {
                        month_scale_date: scheduler.date.date_to_str("%l"),
                        week_scale_date: scheduler.date.date_to_str("%l, %F %j"),
                        event_bar_date: function(start,end,ev) {
                            return "â€¢ <b>"+scheduler.templates.event_date(start)+"</b> ";
                        }
                    }
                };

                function resetConfig(){
                    var settings;
                    if(window.innerWidth < 1000){
                        settings = compactView;
                    }else{
                        settings = fullView;

                    }
                    scheduler.utils.mixin(scheduler.config, settings.config, true);
                    scheduler.utils.mixin(scheduler.templates, settings.templates, true);
                    scheduler.utils.mixin(scheduler.xy, settings.xy, true);
                    return true;
                }

                scheduler.config.responsive_lightbox = true;
                resetConfig();
                scheduler.attachEvent("onBeforeViewChange", resetConfig);
                scheduler.attachEvent("onSchedulerResize", resetConfig);
            });
        </script>
        <style>
            html, body{
                margin:0px;
                padding:0px;
                height:100%;
                overflow:hidden;
            }
            {{ specification['css'] | safe }}
        </style>
    </head>
    <body>
        <div id="scheduler_here" class="dhx_cal_container"
            style='width:100%; height:100%;'>
            <div class="dhx_cal_navline">
                {%- if "previous" in specification["controls"] -%}
                <div class="dhx_cal_prev_button">&nbsp;</div>
                {%- endif -%}
                {%- if "next" in specification["controls"] -%}
                <div class="dhx_cal_next_button">&nbsp;</div>
                {%- endif -%}
                {%- if "today" in specification["controls"] -%}
                <div class="dhx_cal_today_button"></div>
                {%- endif -%}
                {%- if "date" in specification["controls"] -%}
                <div class="dhx_cal_date"></div>
                {%- endif -%}
                {%- if "day" in specification["tabs"] -%}
                <div class="dhx_cal_tab" name="day_tab"></div>
                {%- endif -%}
                {%- if "week" in specification["tabs"] -%}
                <div class="dhx_cal_tab" name="week_tab"></div>
                {%- endif -%}
                {%- if "month" in specification["tabs"] -%}
                <div class="dhx_cal_tab" name="month_tab"></div>
                {%- endif -%}
                {%- if "agenda" in specification["tabs"] -%}
                <div class="dhx_cal_tab" name="agenda_tab" id="agenda_tab"></div>
                {%- endif -%}
            </div>
            <div class="dhx_cal_header"></div>
            <div class="dhx_cal_data"></div>
        </div>
        <div id="loader" class="fullsize"></div>
        <div id="errorWindow" class="hidden fullsize">
            <a class="closeButton" href="javascript:toggleErrorWindow();">X</a>
        </div>
        <div class="status-window">
            <a class="item" id="errorStatusIcon" href="javascript:toggleErrorWindow();">!</a>
            <a class="item" id="infoIcon" href="/about.html{{ get_query_string() | safe }}" target="{{ specification['target'] }}">?</a>
        </div>
    </body>
</html>
